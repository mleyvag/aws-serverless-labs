# Laboratorio 04: Gesti√≥n de Usuarios, Grupos y Validaci√≥n de Accesos en IAM

## üéØ Objetivo

Aprender a gestionar usuarios IAM con distintos niveles de permisos a trav√©s de **grupos**, habilitar accesos por consola y CLI, y utilizar herramientas de auditor√≠a como **Access Advisor** y **Credential Reports**.

---

## üß∞ Prerrequisitos

- Tener instalada la **AWS CLI** (versi√≥n 2). Puedes descargarla desde:  
  [https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html)

---

## üõ†Ô∏è Pasos del laboratorio

---

### 1. Crear dos usuarios IAM

#### Usuario administrador
1. Ve a **IAM > Users > Create user**.
2. Nombre: `admin`
3. Casillas por marcar:
   - ‚úÖ Provide user access to the AWS Management Console
   - ‚úÖ I want to create an IAM user
   - ‚úÖ Autogenerated password
   - ‚úÖ Users must create a new password at next sign-in - Recommended
4. En **"Set Permissions"** le das al bot√≥n **"Next"**.
5. En **"Review and Create"** le das al bot√≥n **"Create User"**.
6. En **"Retrieve password"** tendr√°s la **"URL, username y password"** que deber√°s guardar.

#### Usuario limitado
1. Repite el proceso para el usuario: `miguel` desde el paso 1 al 6.

> üí° Usa contrase√±as seguras y permite que el usuario cambie su contrase√±a en el primer inicio de sesi√≥n.

### 2. Crear dos grupos IAM

#### Grupo de administradores
1. Ve a **IAM > User Groups > Create group**.
2. Nombre: `administradores`
3. Adjunta la pol√≠tica: `AdministratorAccess`

#### Grupo de permisos limitados
1. Crea otro grupo con nombre: `desarrolladores`
2. Adjunta una pol√≠tica b√°sica como `AWSLambda_FullAccess`

### 3. Asignar usuarios a los grupos

- Asigna `admin` al grupo `administradores`
- Asigna `miguel` al grupo `desarrolladores`

### 4. Validar acceso por consola del usuario admin

1. Inicia sesi√≥n con `admin` y su contrase√±a temporal.
2. Cambia la contrase√±a si es requerido.
3. Explora la consola y verifica que tienes permisos administrativos.

### 5. Crear claves program√°ticas para CLI

1. Estando como `admin`, ve a **"IAM > Users > admin"**
2. Selecciona la pesta√±a **"Security Credentials"**
3. En la secci√≥n **"Access Keys"**, haz clic en **"Create access key"**
4. Elige el **"Use Case"** de tipo **"Command Line Interface (CLI)"** y confirma el checkbox **"I understand the above recommendation and want to proceed to create an access key."**
5. Ponle una descripci√≥n y presiona el bot√≥n **"Create Access Key"**
6. Guarda el **"Access Key ID"** y **"Secret Access Key"**. Finalmente presiona el boton **"Done"**
7. En la terminal configura el perfil con:
```bash
aws configure --profile admin-personal-account
```
8. Ingresa las clases de acceso y elige la regi√≥n.
```bash
AWS Access Key ID [None]:
AWS Secret Access Key [None]:
Default region name [None]:
Default output format [None]:
```
9. Ejecuta el siguiente comando para listar los roles IAM:
```bash
aws s3 ls --profile admin-personal-account
```
### 6. Validar acceso por consola del usuario limitado

1. Inicia sesi√≥n con `miguel` y su contrase√±a temporal.
2. Cambia la contrase√±a si es requerido.
3. Explora la consola y verifica que tienes permisos Full para el servicio Lambda.

### 7. Crear claves program√°ticas para CLI

1. Estando como `miguel`, ve a **"IAM > Users > miguel"**
2. Selecciona la pesta√±a **"Security Credentials"**
3. En la secci√≥n **"Access Keys"**, haz clic en **"Create access key"**
4. Elige el **"Use Case"** de tipo **"Command Line Interface (CLI)"** y confirma el checkbox **"I understand the above recommendation and want to proceed to create an access key."**
5. Ponle una descripci√≥n y presiona el bot√≥n **"Create Access Key"**
6. Guarda el **"Access Key ID"** y **"Secret Access Key"**. Finalmente presiona el boton **"Done"**
7. En la terminal configura el perfil con:
```bash
aws configure --profile miguel-personal-account
```
8. Ingresa las clases de acceso y elige la regi√≥n.
```bash
AWS Access Key ID [None]:
AWS Secret Access Key [None]:
Default region name [None]:
Default output format [None]:
```
9. Ejecuta el siguiente comando para listar los roles IAM:
```bash
aws s3 ls --profile miguel-personal-account

An error occurred (AccessDenied) when calling the ListBuckets operation: User: arn:aws:iam::123456789123:user/miguel is not authorized to perform: s3:ListAllMyBuckets because no identity-based policy allows the s3:ListAllMyBuckets action

```

